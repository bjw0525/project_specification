<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>데이터베이스</title>
  <link rel="stylesheet" href="./css/style.css" />
</head>
<body>
  <nav class="nav">
    <div class="wrap">
      <img src="./images/hero-logo.png" alt="블루 글로우 심볼" style="height:36px;width:auto;border-radius:6px;object-fit:cover" />
      <a class="brand" href="./index.html">Blog Project Docs</a>
      <div class="spacer"></div>
      <div class="links">
        <a href="./index.html">소개</a>
        <a href="./tech-stack.html">기술 스택</a>
        <a href="./database.html">데이터베이스</a>
        <a href="./security.html">보안</a>
        <a href="./getting-started.html">실행 방법</a>
      </div>
      <button class="menu-toggle" aria-label="메뉴 열기">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </button>
    </div>
  </nav>

  <main class="container">
    <section class="hero hero--cover reveal" data-hero="database">
      <div class="hero__content">
        <h1 class="title">운영과 테스트를 아우르는 스키마 아키텍처</h1>
        <p class="subtitle">
          MySQL 8.0 운영 DB와 H2 테스트 DB, 13개 테이블의 규칙을 시각적으로 정리했습니다.
        </p>
        <div class="actions">
          <a class="btn btn-primary" href="./tech-stack.html">기술 스택</a>
          <a class="btn btn-outline-light" href="./getting-started.html">실행 방법</a>
        </div>
      </div>
    </section>

    <section class="stack-showcase reveal" aria-label="데이터베이스 심층 안내">
      <div class="stack-showcase__grid">
        <aside class="stack-legend">
          <p class="stack-legend__intro">
            
          </p>
          <ul class="stack-legend__list">
            <li class="stack-legend__item is-active" data-stack-pill data-stack-label="ERD 개요">ERD 개요</li>
            <li class="stack-legend__item" data-stack-pill data-stack-label="핵심 규칙">핵심 규칙</li>
            <li class="stack-legend__item" data-stack-pill data-stack-label="인덱스 하이라이트">인덱스 하이라이트</li>
            <li class="stack-legend__item" data-stack-pill data-stack-label="스키마 준비">스키마 준비</li>
            <li class="stack-legend__item" data-stack-pill data-stack-label="연결 설정">연결 설정</li>
          </ul>
          <div class="stack-counter">
            <div>
              <span class="stack-counter__current" data-stack-current>01</span>
              <span class="stack-counter__slash">/</span>
              <span data-stack-total>05</span>
            </div>
            <div class="stack-counter__label" data-stack-current-label>ERD 개요</div>
          </div>
        </aside>

        <div class="stack-scroll" data-stack-scroll>
          <article class="stack-card is-active" data-stack-card data-stack-label="ERD 개요">
            <div class="stack-card__eyebrow">Overview</div>
            <h2 class="stack-card__title">ERD 개요</h2>
            <p class="stack-card__summary">
              총 13개 테이블로 회원, 게시글, 스토리, 공지 및 사이트 환경 설정을 나눴습니다. 운영은 MySQL 8.0, 테스트는 H2 인메모리 DB를 사용합니다.
            </p>
            <ul>
              <li>콘텐츠: members, posts, post_images, post_likes, comments, comment_likes</li>
              <li>스토리: stories, story_likes, story_comments, story_comment_likes</li>
              <li>운영: notices, visitor_counts, site_settings</li>
            </ul>
            <p>운영 DB 스키마명은 <code class="inline">blog</code>이며 기본 문자셋은 UTF8MB4로 통일했습니다.</p>
          </article>

          <article class="stack-card" data-stack-card data-stack-label="핵심 규칙">
            <div class="stack-card__eyebrow">Rules</div>
            <h2 class="stack-card__title">핵심 규칙</h2>
            <p class="stack-card__summary">
              삭제, 참조 무결성, 좋아요 유니크 키 등 운영 중 가장 자주 다루는 제약 조건을 명시합니다.
            </p>
            <ul>
              <li>게시글·스토리 삭제 시 파일 및 연관 레코드 CASCADE</li>
              <li>좋아요 유니크 키: <code class="inline">(post_id, username)</code>, <code class="inline">(comment_id, username)</code>, <code class="inline">(story_id, username)</code></li>
              <li>댓글: 트리 구조(parent_id) + 소프트 삭제 플래그</li>
              <li>검색: 게시글 FULLTEXT(title, content) + 주요 컬럼 인덱스</li>
            </ul>
          </article>

          <article class="stack-card" data-stack-card data-stack-label="인덱스 하이라이트">
            <div class="stack-card__eyebrow">Performance</div>
            <h2 class="stack-card__title">인덱스 하이라이트</h2>
            <p class="stack-card__summary">CRUD와 통계 쿼리를 고려한 인덱스 셋업을 카드로 정리했습니다.</p>
            <ul>
              <li>posts: author, category, created_at, FULLTEXT(title, content)</li>
              <li>stories: author, category, created_at, view_count</li>
              <li>comments / story_comments: post_id or story_id, created_at</li>
              <li>members: username, email 유니크 인덱스</li>
            </ul>
          </article>

          <article class="stack-card" data-stack-card data-stack-label="스키마 준비">
            <div class="stack-card__eyebrow">Provisioning</div>
            <h2 class="stack-card__title">스키마 준비</h2>
            <p class="stack-card__summary">환경 구동 직전 실행하는 DDL 및 샘플 데이터 시나리오입니다.</p>
            <pre><code>CREATE DATABASE IF NOT EXISTS blog
  DEFAULT CHARACTER SET utf8mb4
  COLLATE utf8mb4_unicode_ci;

# MySQL 콘솔에서 테이블 스크립트 적용
mysql -u root -p blog &lt; create_tables.sql

# (선택) 테스트 데이터 삽입
mysql -u root -p blog &lt; test_data.sql
            </code></pre>
          </article>

          <article class="stack-card" data-stack-card data-stack-label="연결 설정">
            <div class="stack-card__eyebrow">Connection</div>
            <h2 class="stack-card__title">연결 설정 (발췌)</h2>
            <p class="stack-card__summary">애플리케이션 프로퍼티에 반영하는 JDBC/풀 옵션입니다.</p>
            <pre><code>spring.datasource.url=jdbc:mysql://localhost:3306/blog?serverTimezone=UTC&amp;characterEncoding=UTF-8
spring.datasource.username=root
spring.datasource.password=1111

spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
            </code></pre>
            <p>운영 반영 시 비밀번호는 Secrets Manager 또는 OS 환경 변수로 치환하세요.</p>
          </article>
        </div>
      </div>
    </section>

    <div class="footer">Updated · 데이터베이스 개요</div>
  </main>
  <script src="./js/site.js"></script>
</body>
</html>

